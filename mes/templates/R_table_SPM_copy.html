<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SPM</title>
    <!-- Favicon icon -->
    
    <link rel="icon" type="image/png" sizes="16x16" href="../static/images/DSK-LOGO圖片_1.jpg">
    <!-- Datatable -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="../static/vendor/datatables/css/jquery.dataTables.min.css" rel="stylesheet">
    <!-- Custom Stylesheet -->
    <link href="../static/css/style.css" rel="stylesheet">


</head>

<body>

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper" class="show">
        
        <div class="nav-header">
            <a href="{{ url_for('index') }}" class="brand-logo">
                <img class="logo-abbr" src="../static/images/DSK-LOGO去背_10.png" alt="Logo">                
                <img class="brand-title" src="../static/images/DSK-LOGO去背_12.png" alt="Logo">
            </a> 
                    <!--參考index2  button type="button" id="toggle-btn" class="H-toggle">&#9776;</button -->               
            <div class="nav-control">
                <div class="hamburger sidebar-toggle is-active">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        <!--**********************************
            Nav header end
        ***********************************-->

        <!--**********************************
            Header start
        ***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
                            <div class="search_bar dropdown">
                                <span class="search_icon p-3 c-pointer" data-toggle="dropdown">
                                    <i class="mdi mdi-magnify"></i>
                                </span>
                                <div class="dropdown-menu p-0 m-0">
                                    <form>
                                        <input class="form-control" type="search" placeholder="Search" aria-label="Search">
                                    </form>
                                </div>
                            </div>
                        </div>

                        <ul class="navbar-nav header-right">                           
                            <li class="nav-item dropdown header-profile">
                                <a class="nav-link" href="#" role="button" data-toggle="dropdown">
                                    <i class="mdi mdi-account"></i>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">                                
                                    <a href="page_login.html" class="dropdown-item">
                                        <i class="icon-key"></i>
                                        <span class="ml-2">Logout </span>
                                    </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <!--**********************************
            Header end ti-comment-alt
        ***********************************-->
        <div class="quixnav">
            <div class="quixnav-scroll">
                <ul class="metismenu" id="menu">
                    <li class="nav-label first">Main Menu</li>                    
                        <li><a href="https://docs.google.com/spreadsheets/d/1uG_1YrsVX-U5fAQmkM6Izkf9F0zIfpuQhqm4ILcFV94/edit?usp=sharing"  target="_blank" aria-expanded="false"><i class="icon icon-chart-bar-33"></i><span
                            class="nav-text">戰情看板</span></a></li>
                        <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                            class="icon icon-layout-25"></i><span class="nav-text">SFC 生產管理</span></a>
                    <ul>
                        <li><a href="{{ url_for('table_workplan') }}" >生產計劃</a></li>                 
                    </ul>
                </li>
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                                class="icon icon-app-store"></i><span class="nav-text">WMS 倉庫管理</span></a>
                        <ul aria-expanded="false">
                            <li><a href="{{ url_for('R_table_IMT') }}">入庫管理</a></li>
                            <li><a href="{{ url_for('R_table_OMT') }}">出庫管理</a></li>                               
                            <li><a href="{{ url_for('R_table_NG') }}">報廢管理</a></li>
                            <li><a href="{{ url_for('R_table_OK') }}">出貨管理</a></li>
                        </ul>
                    </li>                   

                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                                class="icon icon-single-copy-06"></i><span class="nav-text">QMS 品質管理</span></a>
                        <ul aria-expanded="false">
                            <li><a href="{{ url_for('R_table_QMS') }}">良率分析</a></li>                           
                        </ul>
                    </li>

                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                        class="icon icon-form"></i><span class="nav-text">SPM 備品管理</span></a>
                        <ul aria-expanded="false">
                            <li><a href="{{ url_for('R_table_SPM') }}">庫存水位</a></li>                            
                        </ul>
                    </li>
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                        class="icon icon-globe-2"></i><span class="nav-text">TPM 設備管理</span></a>
                        <ul aria-expanded="false">
                            <li><a href="{{ url_for('table_TPM_checklist') }}">點檢表管理</a></li> 
                            <li><a href="{{ url_for('table_MT') }}">保養單管理</a></li>                      
                        </ul>
                    </li> 
                    <li><a class="has-arrow" href="javascript:void()" aria-expanded="false"><i
                        class="icon icon-plug"></i><span class="nav-text">MDS 模具壽命管理</span></a>
                        <ul aria-expanded="false">                        
                            <li><a href="{{ url_for('table_MDS') }}">保養單</a></li>
                        </ul>
                    </li>    
                </ul>
            </div>
        </div>
        <!--**********************************
            Content body start
        ***********************************-->
       
        <div class="content-body">
            <div class="container-fluid">              
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Basic Datatable</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="example" class="display" style="min-width: 845px">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Position</th>
                                                <th>Office</th>
                                                <th>Age</th>
                                                <th>Start date</th>
                                                <th>Salary</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Tiger Nixon</td>
                                                <td>System Architect</td>
                                                <td>Edinburgh</td>
                                                <td>61</td>
                                                <td>2011/04/25</td>
                                                <td>$320,800</td>
                                            </tr>
                                            <tr>
                                                <td>Garrett Winters</td>
                                                <td>Accountant</td>
                                                <td>Tokyo</td>
                                                <td>63</td>
                                                <td>2011/07/25</td>
                                                <td>$170,750</td>
                                            </tr>
                                            <tr>
                                                <td>Ashton Cox</td>
                                                <td>Junior Technical Author</td>
                                                <td>San Francisco</td>
                                                <td>66</td>
                                                <td>2009/01/12</td>
                                                <td>$86,000</td>
                                            </tr>
                                            <tr>
                                                <td>Cedric Kelly</td>
                                                <td>Senior Javascript Developer</td>
                                                <td>Edinburgh</td>
                                                <td>22</td>
                                                <td>2012/03/29</td>
                                                <td>$433,060</td>
                                            </tr>
                                            <tr>
                                                <td>Airi Satou</td>
                                                <td>Accountant</td>
                                                <td>Tokyo</td>
                                                <td>33</td>
                                                <td>2008/11/28</td>
                                                <td>$162,700</td>
                                            </tr>
                                            <tr>
                                                <td>Brielle Williamson</td>
                                                <td>Integration Specialist</td>
                                                <td>New York</td>
                                                <td>61</td>
                                                <td>2012/12/02</td>
                                                <td>$372,000</td>
                                            </tr>
                                            <tr>
                                                <td>Herrod Chandler</td>
                                                <td>Sales Assistant</td>
                                                <td>San Francisco</td>
                                                <td>59</td>
                                                <td>2012/08/06</td>
                                                <td>$137,500</td>
                                            </tr>
                                            <tr>
                                                <td>Rhona Davidson</td>
                                                <td>Integration Specialist</td>
                                                <td>Tokyo</td>
                                                <td>55</td>
                                                <td>2010/10/14</td>
                                                <td>$327,900</td>
                                            </tr>
                                            <tr>
                                                <td>Colleen Hurst</td>
                                                <td>Javascript Developer</td>
                                                <td>San Francisco</td>
                                                <td>39</td>
                                                <td>2009/09/15</td>
                                                <td>$205,500</td>
                                            </tr>
                                            <tr>
                                                <td>Sonya Frost</td>
                                                <td>Software Engineer</td>
                                                <td>Edinburgh</td>
                                                <td>23</td>
                                                <td>2008/12/13</td>
                                                <td>$103,600</td>
                                            </tr>
                                            <tr>
                                                <td>Jena Gaines</td>
                                                <td>Office Manager</td>
                                                <td>London</td>
                                                <td>30</td>
                                                <td>2008/12/19</td>
                                                <td>$90,560</td>
                                            </tr>
                                            <tr>
                                                <td>Quinn Flynn</td>
                                                <td>Support Lead</td>
                                                <td>Edinburgh</td>
                                                <td>22</td>
                                                <td>2013/03/03</td>
                                                <td>$342,000</td>
                                            </tr>
                                            <tr>
                                                <td>Charde Marshall</td>
                                                <td>Regional Director</td>
                                                <td>San Francisco</td>
                                                <td>36</td>
                                                <td>2008/10/16</td>
                                                <td>$470,600</td>
                                            </tr>
                                            <tr>
                                                <td>Haley Kennedy</td>
                                                <td>Senior Marketing Designer</td>
                                                <td>London</td>
                                                <td>43</td>
                                                <td>2012/12/18</td>
                                                <td>$313,500</td>
                                            </tr>
                                            <tr>
                                                <td>Tatyana Fitzpatrick</td>
                                                <td>Regional Director</td>
                                                <td>London</td>
                                                <td>19</td>
                                                <td>2010/03/17</td>
                                                <td>$385,750</td>
                                            </tr>
                                            <tr>
                                                <td>Michael Silva</td>
                                                <td>Marketing Designer</td>
                                                <td>London</td>
                                                <td>66</td>
                                                <td>2012/11/27</td>
                                                <td>$198,500</td>
                                            </tr>
                                            <tr>
                                                <td>Paul Byrd</td>
                                                <td>Chief Financial Officer (CFO)</td>
                                                <td>New York</td>
                                                <td>64</td>
                                                <td>2010/06/09</td>
                                                <td>$725,000</td>
                                            </tr>
                                            <tr>
                                                <td>Gloria Little</td>
                                                <td>Systems Administrator</td>
                                                <td>New York</td>
                                                <td>59</td>
                                                <td>2009/04/10</td>
                                                <td>$237,500</td>
                                            </tr>
                                            <tr>
                                                <td>Bradley Greer</td>
                                                <td>Software Engineer</td>
                                                <td>London</td>
                                                <td>41</td>
                                                <td>2012/10/13</td>
                                                <td>$132,000</td>
                                            </tr>
                                            <!-- 新增的項目將會顯示在這裡 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>      
        </div>
                
        <script>
            let newRow = null;
        
            // 儲存的資料變數
            let savedData = [];
        
            // 載入 Google Sheet 資料
            function loadGoogleSheet() {
                const table = document.getElementById("SPM_Table");
                const thead = table.querySelector("thead tr");
                const tbody = table.querySelector("tbody");
        
                const csvUrl = "https://docs.google.com/spreadsheets/d/1uG_1YrsVX-U5fAQmkM6Izkf9F0zIfpuQhqm4ILcFV94/export?format=csv&gid=1081204972";
        
                fetch(csvUrl)
                    .then(response => response.text())
                    .then(data => {
                        const rows = data.split("\n").map(row => row.split(","));
        
                        // 動態插入表格標題
                        const headers = rows[0];
                        headers.forEach(header => {
                            const th = document.createElement("th");
                            th.textContent = header || "";
                            thead.appendChild(th);
                        });
        
                        // 動態插入資料列
                        rows.slice(1).forEach(row => {
                            const tr = document.createElement("tr");
                            row.forEach(cell => {
                                const td = document.createElement("td");
                                td.textContent = cell || "";
                                tr.appendChild(td);
                            });
                            tbody.appendChild(tr);
                        });
                    })
                    .catch(err => console.error("Error loading Google Sheet:", err));
            }
        
            // 按下新增按鈕時，在第一列插入輸入框
            document.getElementById("add_SPMrowBtn").addEventListener("click", () => {
                const table = document.getElementById("SPM_Table");
                const tbody = table.querySelector("tbody");
        
                const tr = document.createElement("tr");
        
                // 新增輸入框 (Product, People, total)
                tr.innerHTML = `
                    <td><input type="text" class="form-control" id="productInput"></td>
                    <td><input type="text" class="form-control" id="peopleInput"></td>
                    <td><input type="number" class="form-control" id="totalInput"></td>
                    <td><input type="text" class="form-control" id="numberInput" disabled></td>
                    <td><input type="text" class="form-control" id="dateInput" disabled></td>
                `;
        
                // 插入到表格的第一列
                tbody.insertBefore(tr, tbody.firstChild);
        
                newRow = tr; // 保存新增行以便儲存
            });
        
            // 按下儲存按鈕時
            document.getElementById("save_SPMBtn").addEventListener("click", () => {
                if (newRow) {
                    const product = document.getElementById("productInput").value;
                    const people = document.getElementById("peopleInput").value;
                    const total = document.getElementById("totalInput").value;
                    const number = total; // Number = total
                    const date = new Date().toLocaleDateString(); // 使用當前日期
        
                    // 顯示確認訊息框
                    const confirmation = confirm(`請確認新增資料：
                        \nProduct: ${product}
                        \nPeople: ${people}
                        \nTotal: ${total}
                        \nNumber: ${number}
                        \nDate: ${date}`);
        
                    if (confirmation) {
                        // 儲存資料
                        savedData.push({
                            product,
                            people,
                            total,
                            number,
                            date
                        });
        
                        // 更新表格，並填入Number及Date欄位
                        const tdNumber = newRow.querySelector("#numberInput");
                        const tdDate = newRow.querySelector("#dateInput");
        
                        tdNumber.value = number; // 設定 Number 欄位
                        tdDate.value = date;     // 設定 Date 欄位
        
                        // 禁用儲存後的欄位，防止編輯
                        newRow.querySelector("#productInput").disabled = true;
                        newRow.querySelector("#peopleInput").disabled = true;
                        newRow.querySelector("#totalInput").disabled = true;
        
                        // 將新增的資料行插入到表格中
                        const tbody = document.querySelector("#SPM_Table tbody");
                        tbody.appendChild(newRow);
        
                       
                    }
                }
            });
        
            // 初始化載入 Google Sheet 資料
            loadGoogleSheet();
        </script>
    <!--**********************************
        Scripts
    ***********************************-->
    <!-- Required vendors -->
    <script src="../static/vendor/global/global.min.js"></script>
    <script src="../static/js/quixnav-init.js"></script>
    <script src="../static/js/custom.min.js"></script>
    <script src="../static/toggle.js"></script>

    <!-- Datatable -->
    <script src="../static/vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="../static/js/plugins-init/datatables.init.js"></script>
    <!--script src="../static/new_workplan.js"></script-->


</body>

</html>